#!/bin/bash
# Check for URL expiration
now=$(date +%s)
expires=1737932758
if (( $now > $expires )); then
    echo "URLs have expired."
   exit
fi
# Check for wget/curl
if hash wget 2>/dev/null; then
    program="wget -O"
elif hash curl 2>/dev/null; then
    program="curl -o"
else
    echo "Could not find wget or curl."
    exit
fi

# Create data directory if it doesn't exist
data_dir="data"
mkdir -p $data_dir

# Download files one by one
if [ ! -f $data_dir/evwatts.public.connector.csv ]; then
$program "$data_dir/evwatts.public.connector.csv" "https://livewire-data.s3.amazonaws.com/evwatts/evwatts.public/connector/evwatts.public.connector.csv?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.connector.csv%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=31ccfba5949f7e8071135aa38879c5156a6ffe395e528d80c91d1f87cbbdb93d"
fi
if [ ! -f $data_dir/evwatts.public.dictionary.txt ]; then
$program "$data_dir/evwatts.public.dictionary.txt" "https://livewire-data.s3.amazonaws.com/evwatts/evwatts.public/dictionary/evwatts.public.dictionary.txt?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.dictionary.txt%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=7921d282612661b0fcf1238ae771246a348de9b442c012559bb5edf60d8fe477"
fi
if [ ! -f $data_dir/evwatts.public.evse.csv ]; then
$program "$data_dir/evwatts.public.evse.csv" "https://livewire-data.s3.amazonaws.com/evwatts/evwatts.public/evse/evwatts.public.evse.csv?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.evse.csv%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=111a837365df89e97f2688dd4f1a38673fc3111470fd85079f2dd7c9519862d1"
fi
if [ ! -f $data_dir/evwatts.public.session.csv ]; then
$program "$data_dir/evwatts.public.session.csv" "https://livewire-data.s3.amazonaws.com/evwatts/evwatts.public/session/evwatts.public.session.csv?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.session.csv%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=0d91b54c69f0885390748b0b5ba2843c660e3270c7ae281fe178231e8f2ea61d"
fi
if [ ! -f $data_dir/evwatts.public.vehicles.csv ]; then
$program "$data_dir/evwatts.public.vehicles.csv" "https://livewire-ansible-prod-archive.s3.amazonaws.com/evwatts/evwatts.public/vehicles/evwatts.public.vehicles.csv?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.vehicles.csv%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=dbadc4b66cf504feb6da18721d35f483446a0f1c3112d8fc3554b9b297cad1cc"
fi
if [ ! -f $data_dir/evwatts.public.vehiclesessions.csv ]; then
$program "$data_dir/evwatts.public.vehiclesessions.csv" "https://livewire-ansible-prod-archive.s3.amazonaws.com/evwatts/evwatts.public/vehiclesessions/evwatts.public.vehiclesessions.csv?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.vehiclesessions.csv%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=9734713d722e9852b99454073e44f39df712741c37724f7be2b92dd3411bbcc1"
fi
if [ ! -f $data_dir/evwatts.public.vehicletrips.csv ]; then
$program "$data_dir/evwatts.public.vehicletrips.csv" "https://livewire-ansible-prod-archive.s3.amazonaws.com/evwatts/evwatts.public/vehicletrips/evwatts.public.vehicletrips.csv?response-content-disposition=%27attachment%3B%20filename%3D%22evwatts.public.vehicletrips.csv%22%3B%27&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA24DU6O2GCJQXI5UJ%2F20250119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250119T230558Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCtiJbdzi6wcwTS5Aj%2B9%2BBjJhnPACJr4Qi8a4mS%2F7SRhwIgbwloZtnmjZgjpuFsPFyrHq%2BXJyId5QSazYanlTPyYzIqgwMImP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAEGgw3NDc1Njk1NzU1NjQiDBAMuNDXzexKMnaPLSrXAuaz9nnKU1ZiHu7jE0HKTPAl3jWobotbbbI6FmS%2FTXCqcVPpgYvItkjAMCrMkQhI9UvfTvylTLnnK8DD3xzV5IdpAQgWSW6l%2FGAdas7KjKDfCu6RLNjdk8NZ2CW5y72PrrFYIJyK2OUIApSyII%2B4Mf%2BMCmrW3dxvvqYHbXnt26tCU4ZlpHQo7MyhiYfdAE4Z1FMAmUZRKFcu3QZlQPKRQ%2BxmfiM%2BWgd6ZNntWC%2BbYhsRzlEb6jrKdvwndnTnebYbj8rQjm7856Avo3CV168s1nikfrs3ceGNm5JF291o94FU7mUk9%2FjxFqV1OpJIIhyNkEPCHJhAjyPXEIBtsORn2HiYAebsqKWD5OSqiGJ5x393l6%2FwSufuxzq5l6tAz5f1Rso4JJ7e9gpCrafW%2F%2F8CA8jB0W4b0CzK6Kss8ZI%2FHnm033TNjVgFRSXL5GMSvdhVMzSUiSNFA0gw1Iq2vAY6ngHTsDoMhAnaS70964THTS4WKoq6P%2BNVy8UydAMQepyEJ7fa9Dj37Gll%2BufvJtXbnU4nD5NqFh4lKhHi5xIMs03T3nbzyhSpQCNhOFW2Of%2B6zS0o4nhZSQl5nm3843RzJo1h%2FEEMITe1H6z5ikPMLA82syg9G6kGzbHXp8bf9mknb3eHT4MZuVTnHLSYvBci6WNQ9miCrl4j5XM%2FUkVxqw%3D%3D&X-Amz-Signature=f39ea32bc00fe34fe4c4bcba27d894d62765f2efd87827dad816748d2ce328fd"
fi
